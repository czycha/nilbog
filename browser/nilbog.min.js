var Nilbog=function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:n})},r.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=5)}([function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();var o=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return n(e,null,[{key:"filter",value:function(e){var t=e.prevent,r=new Set,n=!1;return["create","modify","delete"].forEach(function(e){var o=t[e];if(!0===o)return n=!0,!1;o.forEach(function(e){r.add(e)})}),n?void 0:Array.from(r)}},{key:"normalize",value:function(e){return!0===e?{create:!0,delete:!0,modify:!0}:!1===e?{create:[],delete:[],modify:[]}:{create:e.create?e.create:[],delete:e.delete?e.delete:[],modify:e.modify?e.modify:[]}}},{key:"deliberate",value:function(e,t){var r=e.allow,n=e.prevent,o=t.added,i=void 0===o?[]:o,a=t.removed,u=void 0===a?[]:a,c=t.modified,l=void 0===c?[]:c,s=function(e,t){var o=r[e],i=n[e];return t.filter(function(e){return(!0!==i||!0!==o)&&(!0===i&&!0!==o?!o.includes(e):!0!==i&&!0===o?i.includes(e):i.includes(e)&&!o.includes(e))})};return{create:s("create",i),delete:s("delete",u),modify:s("modify",l)}}}]),e}();t.default=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var r=Array.prototype.slice;"length"in e||(e=[e]),e=r.call(e);for(;e.length;){var n=e.shift();n&&void 0===t(n)&&n.childNodes&&n.childNodes.length&&(e=r.call(n.childNodes).concat(e))}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PreventObserverList=t.ChangelogObserverList=t.ObserverList=void 0;var n,o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=r(0),a=(n=i)&&n.__esModule?n:{default:n};function u(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function c(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var s=function(){function e(){l(this,e),this.observers=[]}return o(e,[{key:"add",value:function(e){this.observers.push(e)}},{key:"conflicts",value:function(e,t){return this.observers.filter(function(r){return!r.equals(e)&&r.connected&&r.matches(t)&&(n=r.parent,o=e.parent,n===o||n.contains(o)||o.contains(n));var n,o})}},{key:"resolve",value:function(e,t){var r=this.conflicts(e,t);return 0===r.length||this.tiebreaker(e,r)}},{key:"tiebreaker",value:function(e,t){var r=t.map(function(e){return e.uid});return r.push(e.uid),r.sort()[0]===e.uid}}]),e}(),f=function(e){function t(e){l(this,t);var r=u(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return r.error=e,r}return c(t,s),o(t,[{key:"resolve",value:function(e,t,r){var n=!0,o=this.conflicts(e,t);return!(o.length>0&&!(n=this.tiebreaker(e,o)))&&(r.conflicts(e,t).length>0&&(console.warn(this.error),n=!1),n)}}]),t}(),d=function(e){function t(){return l(this,t),u(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return c(t,s),o(t,[{key:"resolve",value:function(e,t,r){var n=this.conflicts(e,t);return!(0!==n.length&&!this.tiebreaker(e,n))||this.lowLevelTiebreakers(r,e,n)}},{key:"lowLevelTiebreakers",value:function(e,t,r){var n=this,o={create:{},delete:{},modify:{}},i=["create","delete","modify"],u={added:e.create,removed:e.delete,modified:e.modify};r.forEach(function(e){var t=e.extras[0],r=a.default.deliberate(t,u);i.forEach(function(t){r[t].forEach(function(r){void 0===o[t][r]&&(o[t][r]=[]),o[t][r].push(e)})})});var c={create:[],delete:[],modify:[]};return i.forEach(function(r){c[r]=e[r].filter(function(e){return!o[r][e]||n.tiebreaker(t,o[r][e])})}),c}}]),t}(),v=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(l(this,e),this.noop=t,!t){var r="Nilbog conflict: preventCreate and preventDelete targeting same node. No action taken.";this.observers={preventCreate:new f(r),preventDelete:new f(r),protectText:new s,protectClasses:new d,protectAttributes:new d}}}return o(e,[{key:"register",value:function(e,t){this.noop||this.observers[e].add(t)}},{key:"resolve",value:function(e,t,r){var n=this;if(this.noop)return!0;var o=function(){for(var o,i=arguments.length,a=Array(i),u=0;u<i;u++)a[u]=arguments[u];return(o=n.observers[e]).resolve.apply(o,[t,r].concat(a))};switch(e){case"preventCreate":return o(this.observers.preventDelete);case"preventDelete":return o(this.observers.preventCreate);default:for(var i=arguments.length,a=Array(i>3?i-3:0),u=3;u<i;u++)a[u-3]=arguments[u];return o.apply(void 0,a)}}}]),e}();t.ObserverList=s,t.ChangelogObserverList=d,t.PreventObserverList=f,t.default=v},function(e,t){e.exports=function(e){return e=e||7,Math.random().toString(35).substr(2,e)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=a(r(3)),i=a(r(1));function a(e){return e&&e.__esModule?e:{default:e}}var u=window.MutationObserver||window.WebkitMutationObserver;var c=function(){function e(t,r,n,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.selector=t,this.observer=new u(i.bind(this)),this.parent=r,this.params=n,this.connected=!1;for(var a=arguments.length,c=Array(a>4?a-4:0),l=4;l<a;l++)c[l-4]=arguments[l];this.extras=c,this.uid=(0,o.default)()}return n(e,[{key:"matches",value:function(e){return function e(t,r){if("string"==typeof r)return(t.matches||t.matchesSelector||t.msMatchesSelector||t.mozMatchesSelector||t.webkitMatchesSelector||t.oMatchesSelector||function(e){for(var t=(this.document||this.ownerDocument).querySelectorAll(e),r=t.length;--r>=0&&t.item(r)!==this;);return r>-1}).call(t,r);if(Element.prototype.isPrototypeOf(r))return t===r;if(NodeList.prototype.isPrototypeOf(r)||Array.isArray(r)){var n=!1;return r.forEach(function(r){if(n=e(t,r))return!1}),n}return!1}(e,this.selector)}},{key:"containsMatches",value:function(e){var t=this,r=[];return(0,i.default)(e,function(e){if(t.matches(e))return r.push(e),!0}),r}},{key:"inspect",value:function(){return this.uid}},{key:"equals",value:function(e){return this.uid===e.uid}},{key:"connect",value:function(){return this.connected||(this.observer.observe(this.parent,this.params),this.connected=!0),!0}},{key:"disconnect",value:function(){return this.connected&&(this.observer.disconnect(),this.connected=!1),!0}},{key:"operate",value:function(e){if(this.connected){this.disconnect();var t=e.call(this);return this.connect(),t}return e.call(this)}}]),e}();t.default=c},function(e,t,r){"use strict";var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=c(r(4)),i=c(r(2)),a=c(r(0)),u=c(r(1));function c(e){return e&&e.__esModule?e:{default:e}}function l(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}function s(e,t,r){r?e.insertBefore(t,r):e.appendChild(t)}var f=function(){function e(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.safe=t,this.conflictManager=new i.default(!this.safe)}return n(e,[{key:"preventCreate",value:function(e){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).parent,r=void 0===t?document.documentElement:t,n=this.conflictManager,i=new o.default(e,r,{childList:!0,subtree:!0},function(e){var t=this;e.forEach(function(e){e.addedNodes.forEach(function(e){t.matches(e)&&n.resolve("preventCreate",t,e)&&e.remove()})})});return n.register("preventCreate",i),i.connect(),i}},{key:"protectText",value:function(e){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).parent,r=void 0===t?document.documentElement:t,n=this.conflictManager,i=new o.default(e,r,{characterData:!0,characterDataOldValue:!0,subtree:!0,childList:!0},function(e){var t=this,r=[],o=function(e,o){return e.nodeType===Node.TEXT_NODE&&t.matches(o)&&!r.includes(o)&&n.resolve("protectText",t,o)};e.forEach(function(e){var i=e.type,a=e.target,u=e.oldValue,c=e.addedNodes,l=e.removedNodes,f=e.nextSibling,d=Array.from(c).filter(function(e){return o(e,a)}),v=Array.from(l).filter(function(e){return o(e,a)});"characterData"===i&&function(e){return t.matches(e.parentNode)&&!r.includes(e)&&n.resolve("protectText",t,e.parentNode)}(a)&&(t.operate(function(){a.data=u}),r.push(a)),"childList"===i&&(d.length>0||v.length>0)&&t.operate(function(){d.forEach(function(e){return e.remove()}),v.forEach(function(e){return s(a,e,f)})})})});return n.register("protectText",i),i.connect(),i}},{key:"protectAttributes",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.parent,n=void 0===r?document.documentElement:r,i=t.rules,u=void 0===i?{prevent:!0,allow:!1}:i,c=this.conflictManager,l=a.default.normalize(u.allow),s=a.default.normalize(u.prevent),f={attributes:!0,attributeOldValue:!0,subtree:!0,attributeFilter:a.default.filter({allow:l,prevent:s})},d=new o.default(e,n,f,function(e){var t=this,r=[];e.forEach(function(e){var n=e.attributeName,o=e.target,i=e.oldValue;if("class"!==n&&!r.includes(n)&&t.matches(o)){var u={added:[],removed:[],modified:[]},f=void 0;if(null===i)u.added.push(n),f="create";else if(o.hasAttribute(n)){if(i===o.getAttribute(n))return!1;u.modified.push(n),f="modify"}else u.removed.push(n),f="delete";var d=a.default.deliberate({allow:l,prevent:s},u),v=c.resolve("protectAttributes",t,o,d);!0!==v&&(d=v),1===d[f].length&&(t.operate(function(){switch(f){case"create":o.removeAttribute(n);break;case"delete":case"modify":o.setAttribute(n,i)}}),r.push(n))}})},{allow:l,prevent:s});return c.register("protectAttributes",d),d.connect(),d}},{key:"protectClasses",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.parent,n=void 0===r?document.documentElement:r,i=t.rules,u=void 0===i?{prevent:!0,allow:!1}:i,c=this.conflictManager,s=a.default.normalize(u.allow),f=a.default.normalize(u.prevent),d=new o.default(e,n,{attributes:!0,attributeOldValue:!0,subtree:!0,attributeFilter:["class"]},function(e){var t=this,r=e.filter(function(e){return t.matches(e.target)});if(0===r.length)return!1;var n=void 0;r.forEach(function(e){e.attributeName;var r,o,i,u,d,v=e.target,h=e.oldValue,p=v.getAttribute("class").split(" ").filter(function(e){return""!==e}),b=n?(r=n,o=new Set(p),r.added.forEach(function(e){o.delete(e)}),r.removed.forEach(function(e){o.add(e)}),Array.from(o)):h.split(" ").filter(function(e){return""!==e}),y=(u=b,{added:(d={left:(i=p).filter(function(e){return!u.includes(e)}),right:u.filter(function(e){return!i.includes(e)}),middle:i.filter(function(e){return u.includes(e)})}).left,removed:d.right});n=y;var m=a.default.deliberate({allow:s,prevent:f},y),g=c.resolve("protectClasses",t,v,m);if(!0!==g&&(m=g),m.delete.length>0||m.create.length>0){var w=[].concat(l(p.filter(function(e){return!m.create.includes(e)})),l(m.delete)).join(" ");t.operate(function(){v.setAttribute("class",w)})}})},{allow:s,prevent:f});return c.register("protectClasses",d),d.connect(),d}},{key:"preventDelete",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.parent,n=void 0===r?document.documentElement:r,i=t.onTreeDeletion,a=void 0!==i&&i;if(![!1,"recreate-full-tree","recreate-direct-path","place-at-top-level"].includes(a))throw new TypeError('onTreeDeletion must be one of: [false, "recreate-full-tree", "recreate-full-tree", "place-at-top-level"]. Received: '+a);var c=this.conflictManager,l=new o.default(e,n,{childList:!0,subtree:!0},function(e){var t=this,r=function(e){return c.resolve("preventDelete",t,e)};e.forEach(function(e){var n=e.removedNodes,o=e.target,i=e.nextSibling,c=function(e){return s(o,e,i)};n.forEach(function(e){var n=void 0;if(t.matches(e))r(e)&&c(e);else if(a&&(n=t.containsMatches(e).filter(r)).length>0)switch(a){case"place-at-top-level":n.forEach(function(e){c(e)});break;case"recreate-full-tree":c(e);break;case"recreate-direct-path":(0,u.default)(e,function(e){return!!function(e){return n.some(function(t){return e.isSameNode(t)})}(e)||(function(e){return n.some(function(t){return e.contains(t)})}(e)?void 0:(e.remove(),!0))}),c(e)}})})});return c.register("preventDelete",l),l.connect(),l}},{key:"freeze",value:function(){return{protectText:this.protectText.apply(this,arguments),preventDelete:this.preventDelete.apply(this,arguments),protectAttributes:this.protectAttributes.apply(this,arguments),protectClasses:this.protectClasses.apply(this,arguments)}}}]),e}();e.exports=f}]);