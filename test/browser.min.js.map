{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./dist/referee.js","webpack:///./dist/conflicts.js","webpack:///./node_modules/uid/index.js","webpack:///./dist/observer.js","webpack:///./dist/index.js","webpack:///./test/browser.js"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","configurable","enumerable","get","r","value","n","__esModule","object","property","prototype","hasOwnProperty","p","s","_createClass","defineProperties","target","props","length","descriptor","writable","key","Constructor","protoProps","staticProps","Referee","instance","TypeError","_classCallCheck","this","_ref","prevent","observeThese","Set","observeAll","forEach","type","add","undefined","Array","from","ap","create","delete","modify","_ref2","_ref3","allow","_ref3$added","added","_ref3$removed","removed","_ref3$modified","modified","check","items","a","filter","item","includes","default","PreventObserverList","ChangelogObserverList","ObserverList","obj","_referee","_referee2","_possibleConstructorReturn","self","ReferenceError","_inherits","subClass","superClass","constructor","setPrototypeOf","__proto__","observers","observer","push","node","equals","connected","matches","el1","parent","el2","contains","conflicts","tiebreaker","uids","map","uid","sort","_ObserverList","error","_this","getPrototypeOf","other","go","internalConflicts","console","warn","_ObserverList2","apply","arguments","undo","lowLevelTiebreakers","_this3","conflictList","types","changed","conflict","conflictRules","extras","conflictUndo","deliberate","newUndo","ConflictManager","noop","preventMsg","preventCreate","preventDelete","protectText","protectClasses","protectAttributes","action","_this4","resolve","_observers$action","_len2","more","_key2","concat","_len","_key","len","Math","random","toString","substr","_uid","_uid2","MO","window","MutationObserver","WebkitMutationObserver","Observer","selector","observerParams","fn","bind","params","el","_matches","matchesSelector","msMatchesSelector","mozMatchesSelector","webkitMatchesSelector","oMatchesSelector","Element","isPrototypeOf","NodeList","isArray","match","compareTo","observe","disconnect","connect","Promise","then","finally","_observer2","_interopRequireDefault","_conflicts2","_toConsumableArray","arr","arr2","Nilbog","safe","conflictManager","_ref$subtree","subtree","_ref$parent","document","documentElement","childList","records","addedNodes","remove","register","_ref3$subtree","_ref3$parent","characterData","characterDataOldValue","_this2","_ref4","oldValue","parentNode","operate","data","_ref5","_ref5$subtree","_ref5$parent","_ref5$rules","rules","normalize","attributes","attributeOldValue","attributeFilter","_ref6","attributeName","undoThis","hasAttribute","getAttribute","resolution","removeAttribute","setAttribute","_ref7","_ref7$subtree","_ref7$parent","_ref7$rules","_ref8","left","right","_venn","newClasses","split","className","oldClasses","middle","classes","join","_ref9","_ref9$subtree","_ref9$parent","_this5","_ref10","removedNodes","nextSibling","previousSibling","insertBefore","insertAdjacentHTML","appendChild","nilbog","created","createElement","createdText","createTextNode","classList","log","body","freeze","querySelectorAll","addEventListener","setInterval","attachEvent","readyState"],"mappings":"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","file":"browser.min.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 5);\n","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar Referee = function () {\n  function Referee() {\n    _classCallCheck(this, Referee);\n  }\n\n  _createClass(Referee, null, [{\n    key: 'filter',\n    value: function filter(_ref) {\n      var prevent = _ref.prevent;\n\n      var observeThese = new Set();\n      var observeAll = false;\n      var types = ['create', 'modify', 'delete'];\n      types.forEach(function (type) {\n        var p = prevent[type];\n        if (p === true) {\n          observeAll = true;\n          return false;\n        }\n        p.forEach(function (i) {\n          observeThese.add(i);\n        });\n      });\n      return observeAll ? undefined : Array.from(observeThese);\n    }\n  }, {\n    key: 'normalize',\n    value: function normalize(ap) {\n      if (ap === true) {\n        return { create: true, delete: true, modify: true };\n      } else if (ap === false) {\n        return { create: [], delete: [], modify: [] };\n      } else {\n        return {\n          create: !ap.create ? [] : ap.create,\n          delete: !ap.delete ? [] : ap.delete,\n          modify: !ap.modify ? [] : ap.modify\n        };\n      }\n    }\n  }, {\n    key: 'deliberate',\n    value: function deliberate(_ref2, _ref3) {\n      var allow = _ref2.allow,\n          prevent = _ref2.prevent;\n      var _ref3$added = _ref3.added,\n          added = _ref3$added === undefined ? [] : _ref3$added,\n          _ref3$removed = _ref3.removed,\n          removed = _ref3$removed === undefined ? [] : _ref3$removed,\n          _ref3$modified = _ref3.modified,\n          modified = _ref3$modified === undefined ? [] : _ref3$modified;\n\n      var check = function check(type, items) {\n        var a = allow[type];\n        var p = prevent[type];\n        return items.filter(function (item) {\n          if (p === true && a === true) {\n            return false;\n          } else if (p === true && a !== true) {\n            return !a.includes(item);\n          } else if (p !== true && a === true) {\n            return p.includes(item);\n          } else {\n            return p.includes(item) && !a.includes(item);\n          }\n        });\n      };\n      return {\n        create: check('create', added),\n        delete: check('delete', removed),\n        modify: check('modify', modified)\n      };\n    }\n  }]);\n\n  return Referee;\n}();\n\nexports.default = Referee;","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.PreventObserverList = exports.ChangelogObserverList = exports.ObserverList = undefined;\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _referee = require('./referee');\n\nvar _referee2 = _interopRequireDefault(_referee);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction elementsAreRelated(el1, el2) {\n  return el1 === el2 || el1.contains(el2) || el2.contains(el1);\n}\n\nvar ObserverList = function () {\n  function ObserverList() {\n    _classCallCheck(this, ObserverList);\n\n    this.observers = [];\n  }\n\n  _createClass(ObserverList, [{\n    key: 'add',\n    value: function add(observer) {\n      this.observers.push(observer);\n    }\n  }, {\n    key: 'conflicts',\n    value: function conflicts(observer, node) {\n      return this.observers.filter(function (o) {\n        return !o.equals(observer) && o.connected && o.matches(node) && elementsAreRelated(o.parent, observer.parent);\n      });\n    }\n  }, {\n    key: 'resolve',\n    value: function resolve(observer, node) {\n      var conflicts = this.conflicts(observer, node);\n      if (conflicts.length === 0) return true;\n      return this.tiebreaker(observer, conflicts);\n    }\n  }, {\n    key: 'tiebreaker',\n    value: function tiebreaker(observer, conflicts) {\n      var uids = conflicts.map(function (_ref) {\n        var uid = _ref.uid;\n        return uid;\n      });\n      uids.push(observer.uid);\n      return uids.sort()[0] === observer.uid;\n    }\n  }]);\n\n  return ObserverList;\n}();\n\nvar PreventObserverList = function (_ObserverList) {\n  _inherits(PreventObserverList, _ObserverList);\n\n  function PreventObserverList(error) {\n    _classCallCheck(this, PreventObserverList);\n\n    var _this = _possibleConstructorReturn(this, (PreventObserverList.__proto__ || Object.getPrototypeOf(PreventObserverList)).call(this));\n\n    _this.error = error;\n    return _this;\n  }\n\n  _createClass(PreventObserverList, [{\n    key: 'resolve',\n    value: function resolve(observer, node, other) {\n      var go = true;\n      var internalConflicts = this.conflicts(observer, node);\n      if (internalConflicts.length > 0) {\n        go = this.tiebreaker(observer, internalConflicts);\n        if (!go) return false;\n      }\n      var externalConflicts = other.conflicts(observer, node);\n      if (externalConflicts.length > 0) {\n        console.warn(this.error);\n        go = false;\n      }\n      return go;\n    }\n  }]);\n\n  return PreventObserverList;\n}(ObserverList);\n\nvar ChangelogObserverList = function (_ObserverList2) {\n  _inherits(ChangelogObserverList, _ObserverList2);\n\n  function ChangelogObserverList() {\n    _classCallCheck(this, ChangelogObserverList);\n\n    return _possibleConstructorReturn(this, (ChangelogObserverList.__proto__ || Object.getPrototypeOf(ChangelogObserverList)).apply(this, arguments));\n  }\n\n  _createClass(ChangelogObserverList, [{\n    key: 'resolve',\n    value: function resolve(observer, node, undo) {\n      var conflicts = this.conflicts(observer, node);\n      if (conflicts.length === 0 || this.tiebreaker(observer, conflicts)) return true;\n      return this.lowLevelTiebreakers(undo, observer, conflicts);\n    }\n  }, {\n    key: 'lowLevelTiebreakers',\n    value: function lowLevelTiebreakers(undo, observer, conflicts) {\n      var _this3 = this;\n\n      var conflictList = { create: {}, delete: {}, modify: {} };\n      var types = ['create', 'delete', 'modify'];\n      var changed = { added: undo.create, removed: undo.delete, modified: undo.modify };\n      conflicts.forEach(function (conflict) {\n        var conflictRules = conflict.extras[0];\n        var conflictUndo = _referee2.default.deliberate(conflictRules, changed);\n        types.forEach(function (type) {\n          conflictUndo[type].forEach(function (key) {\n            if (conflictList[type][key] === undefined) conflictList[type][key] = [];\n            conflictList[type][key].push(conflict);\n          });\n        });\n      });\n      var newUndo = { create: [], delete: [], modify: [] };\n      types.forEach(function (type) {\n        newUndo[type] = undo[type].filter(function (key) {\n          return !conflictList[type][key] || _this3.tiebreaker(observer, conflictList[type][key]);\n        });\n      });\n      return newUndo;\n    }\n  }]);\n\n  return ChangelogObserverList;\n}(ObserverList);\n\nvar ConflictManager = function () {\n  function ConflictManager() {\n    var noop = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;\n\n    _classCallCheck(this, ConflictManager);\n\n    this.noop = noop;\n    if (!noop) {\n      var preventMsg = 'Nilbog conflict: preventCreate and preventDelete targeting same node. No action taken.';\n\n      this.observers = {\n        preventCreate: new PreventObserverList(preventMsg),\n        preventDelete: new PreventObserverList(preventMsg),\n        protectText: new ObserverList(),\n        protectClasses: new ChangelogObserverList(),\n        protectAttributes: new ChangelogObserverList()\n      };\n    }\n  }\n\n  _createClass(ConflictManager, [{\n    key: 'register',\n    value: function register(type, observer) {\n      if (!this.noop) this.observers[type].add(observer);\n    }\n  }, {\n    key: 'resolve',\n    value: function resolve(action, observer, node) {\n      var _this4 = this;\n\n      if (this.noop) return true;\n      var resolve = function resolve() {\n        var _observers$action;\n\n        for (var _len2 = arguments.length, more = Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n          more[_key2] = arguments[_key2];\n        }\n\n        return (_observers$action = _this4.observers[action]).resolve.apply(_observers$action, [observer, node].concat(more));\n      };\n      switch (action) {\n        case 'preventCreate':\n          return resolve(this.observers['preventDelete']);\n        case 'preventDelete':\n          return resolve(this.observers['preventCreate']);\n        default:\n          for (var _len = arguments.length, extras = Array(_len > 3 ? _len - 3 : 0), _key = 3; _key < _len; _key++) {\n            extras[_key - 3] = arguments[_key];\n          }\n\n          return resolve.apply(undefined, extras);\n      }\n    }\n  }]);\n\n  return ConflictManager;\n}();\n\nexports.ObserverList = ObserverList;\nexports.ChangelogObserverList = ChangelogObserverList;\nexports.PreventObserverList = PreventObserverList;\nexports.default = ConflictManager;","/**\n * Export `uid`\n */\n\nmodule.exports = uid;\n\n/**\n * Create a `uid`\n *\n * @param {String} len\n * @return {String} uid\n */\n\nfunction uid(len) {\n  len = len || 7;\n  return Math.random().toString(35).substr(2, len);\n}\n","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _uid = require('uid');\n\nvar _uid2 = _interopRequireDefault(_uid);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar MO = window.MutationObserver || window.WebkitMutationObserver;\n\nfunction _matches(el, selector) {\n  if (typeof selector === 'string') {\n    return (el.matches || el.matchesSelector || el.msMatchesSelector || el.mozMatchesSelector || el.webkitMatchesSelector || el.oMatchesSelector).call(el, selector);\n  } else if (Element.prototype.isPrototypeOf(selector)) {\n    return el === selector;\n  } else if (NodeList.prototype.isPrototypeOf(selector) || Array.isArray(selector)) {\n    var match = false;\n    selector.forEach(function (compareTo) {\n      match = _matches(el, compareTo);\n      if (match) return false;\n    });\n    return match;\n  } else {\n    return false;\n  }\n}\n\nvar Observer = function () {\n  function Observer(selector, parent, observerParams, fn) {\n    _classCallCheck(this, Observer);\n\n    this.selector = selector;\n\n    this.observer = new MO(fn.bind(this));\n\n    this.parent = parent;\n\n    this.params = observerParams;\n\n    this.connected = false;\n\n    for (var _len = arguments.length, extras = Array(_len > 4 ? _len - 4 : 0), _key = 4; _key < _len; _key++) {\n      extras[_key - 4] = arguments[_key];\n    }\n\n    this.extras = extras;\n\n    this.uid = (0, _uid2.default)();\n  }\n\n  _createClass(Observer, [{\n    key: 'matches',\n    value: function matches(el) {\n      return _matches(el, this.selector);\n    }\n  }, {\n    key: 'inspect',\n    value: function inspect() {\n      return this.uid;\n    }\n  }, {\n    key: 'equals',\n    value: function equals(other) {\n      return this.uid === other.uid;\n    }\n  }, {\n    key: 'connect',\n    value: function connect() {\n      if (!this.connected) {\n        this.observer.observe(this.parent, this.params);\n        this.connected = true;\n      }\n      return true;\n    }\n  }, {\n    key: 'disconnect',\n    value: function disconnect() {\n      if (this.connected) {\n        this.observer.disconnect();\n        this.connected = false;\n      }\n      return true;\n    }\n  }, {\n    key: 'operate',\n    value: function operate(fn) {\n      var _this = this;\n\n      if (this.connected) {\n        if (typeof fn === 'function') {\n          this.disconnect();\n          fn.call(this);\n          this.connect();\n        } else if (Promise.prototype.isPrototypeOf(fn)) {\n          return Promise.resolve(this.disconnect()).then(function () {\n            return fn.call(_this);\n          }).finally(function () {\n            return Promise.resolve(_this.connect());\n          });\n        }\n      } else {\n        if (typeof fn === 'function') {\n          fn.call(this);\n        } else if (Promise.prototype.isPrototypeOf(fn)) {\n          return Promise.resolve(fn.call(this)).finally(function () {\n            return Promise.resolve(true);\n          });\n        }\n      }\n    }\n  }]);\n\n  return Observer;\n}();\n\nexports.default = Observer;","'use strict';\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _observer = require('./observer');\n\nvar _observer2 = _interopRequireDefault(_observer);\n\nvar _conflicts = require('./conflicts');\n\nvar _conflicts2 = _interopRequireDefault(_conflicts);\n\nvar _referee = require('./referee');\n\nvar _referee2 = _interopRequireDefault(_referee);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _toConsumableArray(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } else { return Array.from(arr); } }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction venn(left, right) {\n  return {\n    left: left.filter(function (a) {\n      return !right.includes(a);\n    }),\n    right: right.filter(function (a) {\n      return !left.includes(a);\n    }),\n    middle: left.filter(function (a) {\n      return right.includes(a);\n    })\n  };\n}\n\nfunction arrDiff(oldArr, newArr) {\n  var _venn = venn(newArr, oldArr),\n      added = _venn.left,\n      removed = _venn.right;\n\n  return {\n    added: added,\n    removed: removed\n  };\n}\n\nvar Nilbog = function () {\n  function Nilbog() {\n    var safe = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : true;\n\n    _classCallCheck(this, Nilbog);\n\n    this.safe = safe;\n\n    this.conflictManager = new _conflicts2.default(!this.safe);\n  }\n\n  _createClass(Nilbog, [{\n    key: 'preventCreate',\n    value: function preventCreate(selector) {\n      var _ref = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {},\n          _ref$subtree = _ref.subtree,\n          subtree = _ref$subtree === undefined ? true : _ref$subtree,\n          _ref$parent = _ref.parent,\n          parent = _ref$parent === undefined ? document.documentElement : _ref$parent;\n\n      var conflictManager = this.conflictManager;\n      var params = { childList: true, subtree: subtree };\n      var observer = new _observer2.default(selector, parent, params, function (records) {\n        var _this = this;\n\n        records.forEach(function (_ref2) {\n          var addedNodes = _ref2.addedNodes;\n\n          addedNodes.forEach(function (node) {\n            if (_this.matches(node) && conflictManager.resolve('preventCreate', _this, node)) {\n              node.remove();\n            }\n          });\n        });\n      });\n      conflictManager.register('preventCreate', observer);\n      observer.connect();\n      return observer;\n    }\n  }, {\n    key: 'protectText',\n    value: function protectText(selector) {\n      var _ref3 = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {},\n          _ref3$subtree = _ref3.subtree,\n          subtree = _ref3$subtree === undefined ? true : _ref3$subtree,\n          _ref3$parent = _ref3.parent,\n          parent = _ref3$parent === undefined ? document.documentElement : _ref3$parent;\n\n      var conflictManager = this.conflictManager;\n      var params = { characterData: true, characterDataOldValue: true, subtree: subtree };\n      var observer = new _observer2.default(selector, parent, params, function (records) {\n        var _this2 = this;\n\n        records.forEach(function (_ref4) {\n          var type = _ref4.type,\n              target = _ref4.target,\n              oldValue = _ref4.oldValue;\n\n          if (type === 'characterData' && _this2.matches(target.parentNode) && conflictManager.resolve('protectText', _this2, target.parentNode)) {\n            _this2.operate(function () {\n              target.data = oldValue;\n            });\n          }\n        });\n      });\n      conflictManager.register('protectText', observer);\n      observer.connect();\n      return observer;\n    }\n  }, {\n    key: 'protectAttributes',\n    value: function protectAttributes(selector) {\n      var _ref5 = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {},\n          _ref5$subtree = _ref5.subtree,\n          subtree = _ref5$subtree === undefined ? true : _ref5$subtree,\n          _ref5$parent = _ref5.parent,\n          parent = _ref5$parent === undefined ? document.documentElement : _ref5$parent,\n          _ref5$rules = _ref5.rules,\n          rules = _ref5$rules === undefined ? { prevent: true, allow: false } : _ref5$rules;\n\n      var conflictManager = this.conflictManager;\n      var allow = _referee2.default.normalize(rules.allow);\n      var prevent = _referee2.default.normalize(rules.prevent);\n      var attributeFilter = _referee2.default.filter({ allow: allow, prevent: prevent });\n      var params = {\n        attributes: true,\n        attributeOldValue: true,\n        subtree: subtree,\n        attributeFilter: attributeFilter\n      };\n      var observer = new _observer2.default(selector, parent, params, function (records) {\n        var _this3 = this;\n\n        records.forEach(function (_ref6) {\n          var attributeName = _ref6.attributeName,\n              target = _ref6.target,\n              oldValue = _ref6.oldValue;\n\n          if (_this3.matches(target) && attributeName !== 'class') {\n            var changed = { added: [], removed: [], modified: [] };\n            var undoThis = void 0;\n            if (oldValue === null) {\n              changed.added.push(attributeName);\n              undoThis = 'create';\n            } else if (!target.hasAttribute(attributeName)) {\n              changed.removed.push(attributeName);\n              undoThis = 'delete';\n            } else if (oldValue !== target.getAttribute(attributeName)) {\n              changed.modified.push(attributeName);\n              undoThis = 'modify';\n            } else {\n              return false;\n            }\n            var undo = _referee2.default.deliberate({ allow: allow, prevent: prevent }, changed);\n            var resolution = conflictManager.resolve('protectAttributes', _this3, target, undo);\n            if (resolution !== true) undo = resolution;\n            if (undo[undoThis].length === 1) {\n              _this3.operate(function () {\n                switch (undoThis) {\n                  case 'create':\n                    target.removeAttribute(attributeName);\n                    break;\n                  case 'delete':\n                  case 'modify':\n                    target.setAttribute(attributeName, oldValue);\n                    break;\n                }\n              });\n            }\n          }\n        });\n      }, { allow: allow, prevent: prevent });\n      conflictManager.register('protectAttributes', observer);\n      observer.connect();\n      return observer;\n    }\n  }, {\n    key: 'protectClasses',\n    value: function protectClasses(selector) {\n      var _ref7 = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {},\n          _ref7$subtree = _ref7.subtree,\n          subtree = _ref7$subtree === undefined ? true : _ref7$subtree,\n          _ref7$parent = _ref7.parent,\n          parent = _ref7$parent === undefined ? document.documentElement : _ref7$parent,\n          _ref7$rules = _ref7.rules,\n          rules = _ref7$rules === undefined ? { prevent: true, allow: false } : _ref7$rules;\n\n      var conflictManager = this.conflictManager;\n      var allow = _referee2.default.normalize(rules.allow);\n      var prevent = _referee2.default.normalize(rules.prevent);\n      var params = {\n        attributes: true,\n        attributeOldValue: true,\n        subtree: subtree,\n        attributeFilter: ['class']\n      };\n      var observer = new _observer2.default(selector, parent, params, function (records) {\n        var _this4 = this;\n\n        records.forEach(function (_ref8) {\n          var attributeName = _ref8.attributeName,\n              target = _ref8.target,\n              oldValue = _ref8.oldValue;\n\n          if (_this4.matches(target)) {\n            var newClasses = target.getAttribute('class').split(' ').filter(function (className) {\n              return className !== '';\n            });\n            var oldClasses = oldValue.split(' ').filter(function (className) {\n              return className !== '';\n            });\n            var changed = arrDiff(oldClasses, newClasses);\n            var undo = _referee2.default.deliberate({ allow: allow, prevent: prevent }, changed);\n            var resolution = conflictManager.resolve('protectClasses', _this4, target, undo);\n            if (resolution !== true) undo = resolution;\n            if (undo.delete.length > 0 || undo.create.length > 0) {\n              var classes = [].concat(_toConsumableArray(newClasses.filter(function (className) {\n                return !undo.create.includes(className);\n              })), _toConsumableArray(undo.delete)).join(' ');\n              _this4.operate(function () {\n                target.setAttribute('class', classes);\n              });\n            }\n          }\n        });\n      }, { allow: allow, prevent: prevent });\n      conflictManager.register('protectClasses', observer);\n      observer.connect();\n      return observer;\n    }\n  }, {\n    key: 'preventDelete',\n    value: function preventDelete(selector) {\n      var _ref9 = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {},\n          _ref9$subtree = _ref9.subtree,\n          subtree = _ref9$subtree === undefined ? true : _ref9$subtree,\n          _ref9$parent = _ref9.parent,\n          parent = _ref9$parent === undefined ? document.documentElement : _ref9$parent;\n\n      var conflictManager = this.conflictManager;\n      var params = { childList: true, subtree: subtree };\n      var observer = new _observer2.default(selector, parent, params, function (records) {\n        var _this5 = this;\n\n        records.forEach(function (_ref10) {\n          var removedNodes = _ref10.removedNodes,\n              target = _ref10.target,\n              nextSibling = _ref10.nextSibling,\n              previousSibling = _ref10.previousSibling;\n\n          removedNodes.forEach(function (node) {\n            if (_this5.matches(node) && conflictManager.resolve('preventDelete', _this5, node)) {\n              if (!nextSibling && !previousSibling) {\n                target.appendChild(node);\n              } else if (nextSibling) {\n                target.insertBefore(node, nextSibling);\n              } else if (previousSibling) {\n                previousSibling.insertAdjacentHTML('beforebegin', node);\n              }\n            }\n          });\n        });\n      });\n      conflictManager.register('preventDelete', observer);\n      observer.connect();\n      return observer;\n    }\n  }, {\n    key: 'freeze',\n    value: function freeze() {\n      return {\n        protectText: this.protectText.apply(this, arguments),\n        preventDelete: this.preventDelete.apply(this, arguments),\n        protectAttributes: this.protectAttributes.apply(this, arguments),\n        protectClasses: this.protectClasses.apply(this, arguments)\n      };\n    }\n  }]);\n\n  return Nilbog;\n}();\n\nmodule.exports = Nilbog;","var Nilbog = require('../dist/')\n\nfunction ready(fn) {\n  if (document.attachEvent ? document.readyState === 'complete' : document.readyState !== 'loading') {\n    fn()\n  } else {\n    document.addEventListener('DOMContentLoaded', fn)\n  }\n}\n\nready(function () {\n  var nilbog = new Nilbog(true);\n  nilbog.preventDelete('.prevent-delete')\n\n  nilbog.preventCreate('.prevent-create')\n\n  nilbog.protectText('.protect-text')\n\n  nilbog.freeze('.freeze')\n\n  nilbog.protectClasses('#protect-classes--default')\n  nilbog.protectClasses('#protect-classes--allow-most', {\n    rules: {\n      allow: true,\n      prevent: {\n        create: ['class-d'],\n        delete: ['class-a']\n      }\n    }\n  })\n  nilbog.protectClasses('#protect-classes--prevent-most', {\n    rules: {\n      prevent: true,\n      allow: {\n        create: ['class-d', 'class-b'], // Won't be able to delete class-d\n        delete: ['class-a', 'class-b']  // Won't be able to recreate class-a\n      }\n    }\n  })\n  nilbog.protectClasses('#protect-classes--conflict', {\n    rules: {\n      allow: true,\n      prevent: {\n        create: ['class-d', 'class-e'],\n        delete: ['class-a']\n      }\n    }\n  })\n  nilbog.protectClasses('#protect-classes--conflict', {\n    rules: {\n      allow: true,\n      prevent: {\n        create: ['class-d', 'class-f'],\n        delete: ['class-a', 'class-b']\n      }\n    }\n  })\n\n  nilbog.protectAttributes('.protect-attributes--default')\n  nilbog.protectAttributes('.protect-attributes--allow-most', {\n    rules: {\n      allow: true,\n      prevent: {\n        create: ['attr4'],\n        delete: ['attr1'],\n        modify: ['attr2']\n      }\n    }\n  })\n  nilbog.protectAttributes('.protect-attributes--prevent-most', {\n    rules: {\n      prevent: true,\n      allow: {\n        create: ['attr4', 'attr3'],\n        delete: ['attr1', 'attr3'],\n        modify: ['attr2']\n      }\n    }\n  })\n  nilbog.protectAttributes('.protect-attributes--conflict', {\n    rules: {\n      allow: true,\n      prevent: {\n        create: ['attr4', 'attr5'],\n        delete: ['attr1'],\n        modify: ['attr2']\n      }\n    }\n  })\n  nilbog.protectAttributes('.protect-attributes--conflict', {\n    rules: {\n      allow: true,\n      prevent: {\n        create: ['attr4', 'attr6'],\n        delete: ['attr1', 'attr2'],\n        modify: ['attr2']\n      }\n    }\n  })\n\n  // Should retain events on recreate\n  document.querySelectorAll('.prevent-delete').forEach(function (el) {\n    el.addEventListener('click', function () {\n      console.log('Click event')\n    });\n  });\n\n  function create() {\n    var created = document.createElement('div')\n    var createdText = document.createTextNode('Created')\n    created.classList.add('prevent-create')\n    created.appendChild(createdText)\n    console.log('Appending child:', created)\n    document.body.appendChild(created)\n  }\n  create()\n  setInterval(create, 30000)\n});"],"sourceRoot":""}