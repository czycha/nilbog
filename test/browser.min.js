!function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:n})},r.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=5)}([function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();var o=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return n(e,null,[{key:"filter",value:function(e){var t=e.prevent,r=new Set,n=!1;return["create","modify","delete"].forEach(function(e){var o=t[e];if(!0===o)return n=!0,!1;o.forEach(function(e){r.add(e)})}),n?void 0:Array.from(r)}},{key:"normalize",value:function(e){return!0===e?{create:!0,delete:!0,modify:!0}:!1===e?{create:[],delete:[],modify:[]}:{create:e.create?e.create:[],delete:e.delete?e.delete:[],modify:e.modify?e.modify:[]}}},{key:"deliberate",value:function(e,t){var r=e.allow,n=e.prevent,o=t.added,i=void 0===o?[]:o,a=t.removed,c=void 0===a?[]:a,s=t.modified,l=void 0===s?[]:s,u=function(e,t){var o=r[e],i=n[e];return t.filter(function(e){return(!0!==i||!0!==o)&&(!0===i&&!0!==o?!o.includes(e):!0!==i&&!0===o?i.includes(e):i.includes(e)&&!o.includes(e))})};return{create:u("create",i),delete:u("delete",c),modify:u("modify",l)}}}]),e}();t.default=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PreventObserverList=t.ChangelogObserverList=t.ObserverList=void 0;var n,o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=r(0),a=(n=i)&&n.__esModule?n:{default:n};function c(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var u=function(){function e(){l(this,e),this.observers=[]}return o(e,[{key:"add",value:function(e){this.observers.push(e)}},{key:"conflicts",value:function(e,t){return this.observers.filter(function(r){return!r.equals(e)&&r.connected&&r.matches(t)&&(n=r.parent,o=e.parent,n===o||n.contains(o)||o.contains(n));var n,o})}},{key:"resolve",value:function(e,t){var r=this.conflicts(e,t);return 0===r.length||this.tiebreaker(e,r)}},{key:"tiebreaker",value:function(e,t){var r=t.map(function(e){return e.uid});return r.push(e.uid),r.sort()[0]===e.uid}}]),e}(),f=function(e){function t(e){l(this,t);var r=c(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return r.error=e,r}return s(t,u),o(t,[{key:"resolve",value:function(e,t,r){var n=!0,o=this.conflicts(e,t);return!(o.length>0&&!(n=this.tiebreaker(e,o)))&&(r.conflicts(e,t).length>0&&(console.warn(this.error),n=!1),n)}}]),t}(),d=function(e){function t(){return l(this,t),c(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s(t,u),o(t,[{key:"resolve",value:function(e,t,r){var n=this.conflicts(e,t);return!(0!==n.length&&!this.tiebreaker(e,n))||this.lowLevelTiebreakers(r,e,n)}},{key:"lowLevelTiebreakers",value:function(e,t,r){var n=this,o={create:{},delete:{},modify:{}},i=["create","delete","modify"],c={added:e.create,removed:e.delete,modified:e.modify};r.forEach(function(e){var t=e.extras[0],r=a.default.deliberate(t,c);i.forEach(function(t){r[t].forEach(function(r){void 0===o[t][r]&&(o[t][r]=[]),o[t][r].push(e)})})});var s={create:[],delete:[],modify:[]};return i.forEach(function(r){s[r]=e[r].filter(function(e){return!o[r][e]||n.tiebreaker(t,o[r][e])})}),s}}]),t}(),v=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(l(this,e),this.noop=t,!t){var r="Nilbog conflict: preventCreate and preventDelete targeting same node. No action taken.";this.observers={preventCreate:new f(r),preventDelete:new f(r),protectText:new u,protectClasses:new d,protectAttributes:new d}}}return o(e,[{key:"register",value:function(e,t){this.noop||this.observers[e].add(t)}},{key:"resolve",value:function(e,t,r){var n=this;if(this.noop)return!0;var o=function(){for(var o,i=arguments.length,a=Array(i),c=0;c<i;c++)a[c]=arguments[c];return(o=n.observers[e]).resolve.apply(o,[t,r].concat(a))};switch(e){case"preventCreate":return o(this.observers.preventDelete);case"preventDelete":return o(this.observers.preventCreate);default:for(var i=arguments.length,a=Array(i>3?i-3:0),c=3;c<i;c++)a[c-3]=arguments[c];return o.apply(void 0,a)}}}]),e}();t.ObserverList=u,t.ChangelogObserverList=d,t.PreventObserverList=f,t.default=v},function(e,t){e.exports=function(e){return e=e||7,Math.random().toString(35).substr(2,e)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=r(2),a=(n=i)&&n.__esModule?n:{default:n};var c=window.MutationObserver||window.WebkitMutationObserver;var s=function(){function e(t,r,n,o){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.selector=t,this.observer=new c(o.bind(this)),this.parent=r,this.params=n,this.connected=!1;for(var i=arguments.length,s=Array(i>4?i-4:0),l=4;l<i;l++)s[l-4]=arguments[l];this.extras=s,this.uid=(0,a.default)()}return o(e,[{key:"matches",value:function(e){return function e(t,r){if("string"==typeof r)return(t.matches||t.matchesSelector||t.msMatchesSelector||t.mozMatchesSelector||t.webkitMatchesSelector||t.oMatchesSelector).call(t,r);if(Element.prototype.isPrototypeOf(r))return t===r;if(NodeList.prototype.isPrototypeOf(r)||Array.isArray(r)){var n=!1;return r.forEach(function(r){if(n=e(t,r))return!1}),n}return!1}(e,this.selector)}},{key:"inspect",value:function(){return this.uid}},{key:"equals",value:function(e){return this.uid===e.uid}},{key:"connect",value:function(){return this.connected||(this.observer.observe(this.parent,this.params),this.connected=!0),!0}},{key:"disconnect",value:function(){return this.connected&&(this.observer.disconnect(),this.connected=!1),!0}},{key:"operate",value:function(e){var t=this;if(this.connected){if("function"==typeof e)this.disconnect(),e.call(this),this.connect();else if(Promise.prototype.isPrototypeOf(e))return Promise.resolve(this.disconnect()).then(function(){return e.call(t)}).finally(function(){return Promise.resolve(t.connect())})}else if("function"==typeof e)e.call(this);else if(Promise.prototype.isPrototypeOf(e))return Promise.resolve(e.call(this)).finally(function(){return Promise.resolve(!0)})}}]),e}();t.default=s},function(e,t,r){"use strict";var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=c(r(3)),i=c(r(1)),a=c(r(0));function c(e){return e&&e.__esModule?e:{default:e}}function s(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}var l=function(){function e(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.safe=t,this.conflictManager=new i.default(!this.safe)}return n(e,[{key:"preventCreate",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.subtree,n=void 0===r||r,i=t.parent,a=void 0===i?document.documentElement:i,c=this.conflictManager,s={childList:!0,subtree:n},l=new o.default(e,a,s,function(e){var t=this;e.forEach(function(e){e.addedNodes.forEach(function(e){t.matches(e)&&c.resolve("preventCreate",t,e)&&e.remove()})})});return c.register("preventCreate",l),l.connect(),l}},{key:"protectText",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.subtree,n=void 0===r||r,i=t.parent,a=void 0===i?document.documentElement:i,c=this.conflictManager,s={characterData:!0,characterDataOldValue:!0,subtree:n},l=new o.default(e,a,s,function(e){var t=this;e.forEach(function(e){var r=e.type,n=e.target,o=e.oldValue;"characterData"===r&&t.matches(n.parentNode)&&c.resolve("protectText",t,n.parentNode)&&t.operate(function(){n.data=o})})});return c.register("protectText",l),l.connect(),l}},{key:"protectAttributes",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.subtree,n=void 0===r||r,i=t.parent,c=void 0===i?document.documentElement:i,s=t.rules,l=void 0===s?{prevent:!0,allow:!1}:s,u=this.conflictManager,f=a.default.normalize(l.allow),d=a.default.normalize(l.prevent),v={attributes:!0,attributeOldValue:!0,subtree:n,attributeFilter:a.default.filter({allow:f,prevent:d})},p=new o.default(e,c,v,function(e){var t=this;e.forEach(function(e){var r=e.attributeName,n=e.target,o=e.oldValue;if(t.matches(n)&&"class"!==r){var i={added:[],removed:[],modified:[]},c=void 0;if(null===o)i.added.push(r),c="create";else if(n.hasAttribute(r)){if(o===n.getAttribute(r))return!1;i.modified.push(r),c="modify"}else i.removed.push(r),c="delete";var s=a.default.deliberate({allow:f,prevent:d},i),l=u.resolve("protectAttributes",t,n,s);!0!==l&&(s=l),1===s[c].length&&t.operate(function(){switch(c){case"create":n.removeAttribute(r);break;case"delete":case"modify":n.setAttribute(r,o)}})}})},{allow:f,prevent:d});return u.register("protectAttributes",p),p.connect(),p}},{key:"protectClasses",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.subtree,n=void 0===r||r,i=t.parent,c=void 0===i?document.documentElement:i,l=t.rules,u=void 0===l?{prevent:!0,allow:!1}:l,f=this.conflictManager,d=a.default.normalize(u.allow),v=a.default.normalize(u.prevent),p={attributes:!0,attributeOldValue:!0,subtree:n,attributeFilter:["class"]},h=new o.default(e,c,p,function(e){var t=this;e.forEach(function(e){e.attributeName;var r,n,o,i=e.target,c=e.oldValue;if(t.matches(i)){var l=i.getAttribute("class").split(" ").filter(function(e){return""!==e}),u=c.split(" ").filter(function(e){return""!==e}),p=(n=u,{added:(o={left:(r=l).filter(function(e){return!n.includes(e)}),right:n.filter(function(e){return!r.includes(e)}),middle:r.filter(function(e){return n.includes(e)})}).left,removed:o.right}),h=a.default.deliberate({allow:d,prevent:v},p),b=f.resolve("protectClasses",t,i,h);if(!0!==b&&(h=b),h.delete.length>0||h.create.length>0){var y=[].concat(s(l.filter(function(e){return!h.create.includes(e)})),s(h.delete)).join(" ");t.operate(function(){i.setAttribute("class",y)})}}})},{allow:d,prevent:v});return f.register("protectClasses",h),h.connect(),h}},{key:"preventDelete",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.subtree,n=void 0===r||r,i=t.parent,a=void 0===i?document.documentElement:i,c=this.conflictManager,s={childList:!0,subtree:n},l=new o.default(e,a,s,function(e){var t=this;e.forEach(function(e){var r=e.removedNodes,n=e.target,o=e.nextSibling,i=e.previousSibling;r.forEach(function(e){t.matches(e)&&c.resolve("preventDelete",t,e)&&(o||i?o?n.insertBefore(e,o):i&&i.insertAdjacentHTML("beforebegin",e):n.appendChild(e))})})});return c.register("preventDelete",l),l.connect(),l}},{key:"freeze",value:function(){return{protectText:this.protectText.apply(this,arguments),preventDelete:this.preventDelete.apply(this,arguments),protectAttributes:this.protectAttributes.apply(this,arguments),protectClasses:this.protectClasses.apply(this,arguments)}}}]),e}();e.exports=l},function(e,t,r){var n,o=r(4);n=function(){var e=new o(!0);function t(){var e=document.createElement("div"),t=document.createTextNode("Created");e.classList.add("prevent-create"),e.appendChild(t),console.log("Appending child:",e),document.body.appendChild(e)}e.preventDelete(".prevent-delete"),e.preventCreate(".prevent-create"),e.protectText(".protect-text"),e.freeze(".freeze"),e.protectClasses("#protect-classes--default"),e.protectClasses("#protect-classes--allow-most",{rules:{allow:!0,prevent:{create:["class-d"],delete:["class-a"]}}}),e.protectClasses("#protect-classes--prevent-most",{rules:{prevent:!0,allow:{create:["class-d","class-b"],delete:["class-a","class-b"]}}}),e.protectClasses("#protect-classes--conflict",{rules:{allow:!0,prevent:{create:["class-d","class-e"],delete:["class-a"]}}}),e.protectClasses("#protect-classes--conflict",{rules:{allow:!0,prevent:{create:["class-d","class-f"],delete:["class-a","class-b"]}}}),e.protectAttributes(".protect-attributes--default"),e.protectAttributes(".protect-attributes--allow-most",{rules:{allow:!0,prevent:{create:["attr4"],delete:["attr1"],modify:["attr2"]}}}),e.protectAttributes(".protect-attributes--prevent-most",{rules:{prevent:!0,allow:{create:["attr4","attr3"],delete:["attr1","attr3"],modify:["attr2"]}}}),e.protectAttributes(".protect-attributes--conflict",{rules:{allow:!0,prevent:{create:["attr4","attr5"],delete:["attr1"],modify:["attr2"]}}}),e.protectAttributes(".protect-attributes--conflict",{rules:{allow:!0,prevent:{create:["attr4","attr6"],delete:["attr1","attr2"],modify:["attr2"]}}}),document.querySelectorAll(".prevent-delete").forEach(function(e){e.addEventListener("click",function(){console.log("Click event")})}),t(),setInterval(t,3e4)},(document.attachEvent?"complete"===document.readyState:"loading"!==document.readyState)?n():document.addEventListener("DOMContentLoaded",n)}]);
//# sourceMappingURL=browser.min.js.map