!function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:n})},r.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=6)}([function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();var o=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return n(e,null,[{key:"filter",value:function(e){var t=e.prevent,r=new Set,n=!1;return["create","modify","delete"].forEach(function(e){var o=t[e];if(!0===o)return n=!0,!1;o.forEach(function(e){r.add(e)})}),n?void 0:Array.from(r)}},{key:"normalize",value:function(e){return!0===e?{create:!0,delete:!0,modify:!0}:!1===e?{create:[],delete:[],modify:[]}:{create:e.create?e.create:[],delete:e.delete?e.delete:[],modify:e.modify?e.modify:[]}}},{key:"deliberate",value:function(e,t){var r=e.allow,n=e.prevent,o=t.added,a=void 0===o?[]:o,i=t.removed,c=void 0===i?[]:i,l=t.modified,u=void 0===l?[]:l,s=function(e,t){var o=r[e],a=n[e];return t.filter(function(e){return(!0!==a||!0!==o)&&(!0===a&&!0!==o?!o.includes(e):!0!==a&&!0===o?a.includes(e):a.includes(e)&&!o.includes(e))})};return{create:s("create",a),delete:s("delete",c),modify:s("modify",u)}}}]),e}();t.default=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var r=Array.prototype.slice;"length"in e||(e=[e]),e=r.call(e);for(;e.length;){var n=e.shift();void 0===t(n)&&n.childNodes&&n.childNodes.length&&(e=r.call(n.childNodes).concat(e))}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PreventObserverList=t.ChangelogObserverList=t.ObserverList=void 0;var n,o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=r(0),i=(n=a)&&n.__esModule?n:{default:n};function c(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var s=function(){function e(){u(this,e),this.observers=[]}return o(e,[{key:"add",value:function(e){this.observers.push(e)}},{key:"conflicts",value:function(e,t){return this.observers.filter(function(r){return!r.equals(e)&&r.connected&&r.matches(t)&&(n=r.parent,o=e.parent,n===o||n.contains(o)||o.contains(n));var n,o})}},{key:"resolve",value:function(e,t){var r=this.conflicts(e,t);return 0===r.length||this.tiebreaker(e,r)}},{key:"tiebreaker",value:function(e,t){var r=t.map(function(e){return e.uid});return r.push(e.uid),r.sort()[0]===e.uid}}]),e}(),f=function(e){function t(e){u(this,t);var r=c(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return r.error=e,r}return l(t,s),o(t,[{key:"resolve",value:function(e,t,r){var n=!0,o=this.conflicts(e,t);return!(o.length>0&&!(n=this.tiebreaker(e,o)))&&(r.conflicts(e,t).length>0&&(console.warn(this.error),n=!1),n)}}]),t}(),d=function(e){function t(){return u(this,t),c(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return l(t,s),o(t,[{key:"resolve",value:function(e,t,r){var n=this.conflicts(e,t);return!(0!==n.length&&!this.tiebreaker(e,n))||this.lowLevelTiebreakers(r,e,n)}},{key:"lowLevelTiebreakers",value:function(e,t,r){var n=this,o={create:{},delete:{},modify:{}},a=["create","delete","modify"],c={added:e.create,removed:e.delete,modified:e.modify};r.forEach(function(e){var t=e.extras[0],r=i.default.deliberate(t,c);a.forEach(function(t){r[t].forEach(function(r){void 0===o[t][r]&&(o[t][r]=[]),o[t][r].push(e)})})});var l={create:[],delete:[],modify:[]};return a.forEach(function(r){l[r]=e[r].filter(function(e){return!o[r][e]||n.tiebreaker(t,o[r][e])})}),l}}]),t}(),v=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(u(this,e),this.noop=t,!t){var r="Nilbog conflict: preventCreate and preventDelete targeting same node. No action taken.";this.observers={preventCreate:new f(r),preventDelete:new f(r),protectText:new s,protectClasses:new d,protectAttributes:new d}}}return o(e,[{key:"register",value:function(e,t){this.noop||this.observers[e].add(t)}},{key:"resolve",value:function(e,t,r){var n=this;if(this.noop)return!0;var o=function(){for(var o,a=arguments.length,i=Array(a),c=0;c<a;c++)i[c]=arguments[c];return(o=n.observers[e]).resolve.apply(o,[t,r].concat(i))};switch(e){case"preventCreate":return o(this.observers.preventDelete);case"preventDelete":return o(this.observers.preventCreate);default:for(var a=arguments.length,i=Array(a>3?a-3:0),c=3;c<a;c++)i[c-3]=arguments[c];return o.apply(void 0,i)}}}]),e}();t.ObserverList=s,t.ChangelogObserverList=d,t.PreventObserverList=f,t.default=v},function(e,t){e.exports=function(e){return e=e||7,Math.random().toString(35).substr(2,e)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=i(r(3)),a=i(r(1));function i(e){return e&&e.__esModule?e:{default:e}}var c=window.MutationObserver||window.WebkitMutationObserver;var l=function(){function e(t,r,n,a){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.selector=t,this.observer=new c(a.bind(this)),this.parent=r,this.params=n,this.connected=!1;for(var i=arguments.length,l=Array(i>4?i-4:0),u=4;u<i;u++)l[u-4]=arguments[u];this.extras=l,this.uid=(0,o.default)()}return n(e,[{key:"matches",value:function(e){return function e(t,r){if("string"==typeof r)return(t.matches||t.matchesSelector||t.msMatchesSelector||t.mozMatchesSelector||t.webkitMatchesSelector||t.oMatchesSelector||function(e){for(var t=(this.document||this.ownerDocument).querySelectorAll(e),r=t.length;--r>=0&&t.item(r)!==this;);return r>-1}).call(t,r);if(Element.prototype.isPrototypeOf(r))return t===r;if(NodeList.prototype.isPrototypeOf(r)||Array.isArray(r)){var n=!1;return r.forEach(function(r){if(n=e(t,r))return!1}),n}return!1}(e,this.selector)}},{key:"containsMatches",value:function(e){var t=this,r=[];return(0,a.default)(e,function(e){if(t.matches(e))return r.push(e),!0}),r}},{key:"inspect",value:function(){return this.uid}},{key:"equals",value:function(e){return this.uid===e.uid}},{key:"connect",value:function(){return this.connected||(this.observer.observe(this.parent,this.params),this.connected=!0),!0}},{key:"disconnect",value:function(){return this.connected&&(this.observer.disconnect(),this.connected=!1),!0}},{key:"operate",value:function(e){if(this.connected){this.disconnect();var t=e.call(this);return this.connect(),t}return e.call(this)}}]),e}();t.default=l},function(e,t,r){"use strict";var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=l(r(4)),a=l(r(2)),i=l(r(0)),c=l(r(1));function l(e){return e&&e.__esModule?e:{default:e}}function u(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}var s=function(){function e(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.safe=t,this.conflictManager=new a.default(!this.safe)}return n(e,[{key:"preventCreate",value:function(e){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).parent,r=void 0===t?document.documentElement:t,n=this.conflictManager,a=new o.default(e,r,{childList:!0,subtree:!0},function(e){var t=this;e.forEach(function(e){e.addedNodes.forEach(function(e){t.matches(e)&&n.resolve("preventCreate",t,e)&&e.remove()})})});return n.register("preventCreate",a),a.connect(),a}},{key:"protectText",value:function(e){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).parent,r=void 0===t?document.documentElement:t,n=this.conflictManager,a=new o.default(e,r,{characterData:!0,characterDataOldValue:!0,subtree:!0},function(e){var t=this;e.forEach(function(e){var r=e.type,o=e.target,a=e.oldValue;"characterData"===r&&t.matches(o.parentNode)&&n.resolve("protectText",t,o.parentNode)&&t.operate(function(){o.data=a})})});return n.register("protectText",a),a.connect(),a}},{key:"protectAttributes",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.parent,n=void 0===r?document.documentElement:r,a=t.rules,c=void 0===a?{prevent:!0,allow:!1}:a,l=this.conflictManager,u=i.default.normalize(c.allow),s=i.default.normalize(c.prevent),f={attributes:!0,attributeOldValue:!0,subtree:!0,attributeFilter:i.default.filter({allow:u,prevent:s})},d=new o.default(e,n,f,function(e){var t=this;e.forEach(function(e){var r=e.attributeName,n=e.target,o=e.oldValue;if(t.matches(n)&&"class"!==r){var a={added:[],removed:[],modified:[]},c=void 0;if(null===o)a.added.push(r),c="create";else if(n.hasAttribute(r)){if(o===n.getAttribute(r))return!1;a.modified.push(r),c="modify"}else a.removed.push(r),c="delete";var f=i.default.deliberate({allow:u,prevent:s},a),d=l.resolve("protectAttributes",t,n,f);!0!==d&&(f=d),1===f[c].length&&t.operate(function(){switch(c){case"create":n.removeAttribute(r);break;case"delete":case"modify":n.setAttribute(r,o)}})}})},{allow:u,prevent:s});return l.register("protectAttributes",d),d.connect(),d}},{key:"protectClasses",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.parent,n=void 0===r?document.documentElement:r,a=t.rules,c=void 0===a?{prevent:!0,allow:!1}:a,l=this.conflictManager,s=i.default.normalize(c.allow),f=i.default.normalize(c.prevent),d=new o.default(e,n,{attributes:!0,attributeOldValue:!0,subtree:!0,attributeFilter:["class"]},function(e){var t=this;e.forEach(function(e){e.attributeName;var r,n,o,a=e.target,c=e.oldValue;if(t.matches(a)){var d=a.getAttribute("class").split(" ").filter(function(e){return""!==e}),v=c.split(" ").filter(function(e){return""!==e}),p=(n=v,{added:(o={left:(r=d).filter(function(e){return!n.includes(e)}),right:n.filter(function(e){return!r.includes(e)}),middle:r.filter(function(e){return n.includes(e)})}).left,removed:o.right}),h=i.default.deliberate({allow:s,prevent:f},p),b=l.resolve("protectClasses",t,a,h);if(!0!==b&&(h=b),h.delete.length>0||h.create.length>0){var y=[].concat(u(d.filter(function(e){return!h.create.includes(e)})),u(h.delete)).join(" ");t.operate(function(){a.setAttribute("class",y)})}}})},{allow:s,prevent:f});return l.register("protectClasses",d),d.connect(),d}},{key:"preventDelete",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.parent,n=void 0===r?document.documentElement:r,a=t.onTreeDeletion,i=void 0!==a&&a,l=this.conflictManager,u=new o.default(e,n,{childList:!0,subtree:!0},function(e){var t=this,r=function(e){return l.resolve("preventDelete",t,e)};e.forEach(function(e){var n=e.removedNodes,o=e.target,a=e.nextSibling,l=e.previousSibling,u=function(e){a||l?a?o.insertBefore(e,a):l&&l.insertAdjacentHTML("beforebegin",e):o.appendChild(e)};n.forEach(function(e){var n=void 0;if(t.matches(e))r(e)&&u(e);else if(i&&(n=t.containsMatches(e).filter(r)).length>0)switch(i){case"place-at-top-level":n.forEach(function(e){u(e)});break;case"recreate-full-tree":u(e);break;case"recreate-direct-path":(0,c.default)(e,function(e){return!!function(e){return n.some(function(t){return e.isSameNode(t)})}(e)||(function(e){return n.some(function(t){return e.contains(t)})}(e)?void 0:(e.remove(),!0))}),u(e)}})})});return l.register("preventDelete",u),u.connect(),u}},{key:"freeze",value:function(){return{protectText:this.protectText.apply(this,arguments),preventDelete:this.preventDelete.apply(this,arguments),protectAttributes:this.protectAttributes.apply(this,arguments),protectClasses:this.protectClasses.apply(this,arguments)}}}]),e}();e.exports=s},function(e,t,r){var n,o=new(r(5))(!0);o.preventDelete(".prevent-delete",{onTreeDeletion:"place-at-top-level"}),o.preventCreate(".prevent-create"),o.protectText(".protect-text"),o.freeze(".freeze"),o.protectClasses("#protect-classes--default"),o.protectClasses("#protect-classes--allow-most",{rules:{allow:!0,prevent:{create:["class-d"],delete:["class-a"]}}}),o.protectClasses("#protect-classes--prevent-most",{rules:{prevent:!0,allow:{create:["class-d","class-b"],delete:["class-a","class-b"]}}}),o.protectClasses("#protect-classes--conflict",{rules:{allow:!0,prevent:{create:["class-d","class-e"],delete:["class-a"]}}}),o.protectClasses("#protect-classes--conflict",{rules:{allow:!0,prevent:{create:["class-d","class-f"],delete:["class-a","class-b"]}}}),o.protectAttributes(".protect-attributes--default"),o.protectAttributes(".protect-attributes--allow-most",{rules:{allow:!0,prevent:{create:["attr4"],delete:["attr1"],modify:["attr2"]}}}),o.protectAttributes(".protect-attributes--prevent-most",{rules:{prevent:!0,allow:{create:["attr4","attr3"],delete:["attr1","attr3"],modify:["attr2"]}}}),o.protectAttributes(".protect-attributes--conflict",{rules:{allow:!0,prevent:{create:["attr4","attr5"],delete:["attr1"],modify:["attr2"]}}}),o.protectAttributes(".protect-attributes--conflict",{rules:{allow:!0,prevent:{create:["attr4","attr6"],delete:["attr1","attr2"],modify:["attr2"]}}}),n=function(){function e(){var e=document.createElement("div"),t=document.createTextNode("Created");e.classList.add("prevent-create"),e.appendChild(t),console.log("Appending child:",e),document.body.appendChild(e)}document.querySelectorAll(".prevent-delete").forEach(function(e){e.addEventListener("click",function(){console.log("Click event")})}),e(),setInterval(e,3e4)},(document.attachEvent?"complete"===document.readyState:"loading"!==document.readyState)?n():document.addEventListener("DOMContentLoaded",n)}]);
//# sourceMappingURL=browser.min.js.map